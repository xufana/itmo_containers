# Лабораторная работа 1

## Bad practices

** 1. Использование latest версии **

Делает билд нестабильным, потому что не понятно, как себя поведет "начинка" / выполняемый проект на разных версиях. Решение: указывать версию в явном виде

** 2. Большое количество слоёв ** 

Делая большое количество слоёв, мы раздуваем размер образа, а это влияет на производительность. Решение: похожие по логике команды (как тут, всё то, что apt-get) лучше объединять в один слой

** 3. Делать всё из под root **

Мы рискуем, запуская всё от пользователя с большим количеством прав. Решение: создать пользователя с ограниченным набором прав и запустить часть команд от него

** 4. Отсутствие Healthcheck **

Если что-то сломалось, можем не заметить, а потом не понять, что именно там сломалось. Peшение: добавить healthcheck

## Запуск

** Плохой вариант: **
```
docker build -t airflow-bad -f docker_bad.dockerfile .
docker run -p 8080:8080 -d airflow-bad
```

** Хороший вариант: **
```
docker build -t airflow-good -f docker_good.dockerfile .
docker run -d \
  -v $(pwd)/dags:/opt/airflow/dags \
  -v airflow-logs:/opt/airflow/logs \
  -p 8080:8080 \
  -e API_KEY="mysecretapikey" \
  airflow-good
```

## Что не стоит засовывать в контейнер

1. Монолиты
Оно тяжёлое, будет долго и сложно билдиться, а для того, чтобы поправить минорную деталь, придётся всё перебилдить. Неприятно.

2. Маленькие одноразовые скрипты
Если оно будет запускаться один раз, притом вручную, то не надо это засовывать в контейнер. Как и небольшие пет-проекты, потому что это оверкилл.